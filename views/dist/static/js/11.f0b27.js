webpackJsonp([11,14],{140:function(e,t,a){t=e.exports=a(10)(),t.push([e.id,".info-view{-webkit-box-flex:1;-ms-flex:1;flex:1;background-color:#eee;overflow:hidden}.info-view .form-group{width:500px;margin:0 auto;padding:20px 0}.info-view .form-item{margin:30px 0 0;width:100%;position:relative}.info-view .form-item label{position:absolute;top:-20px;left:0;font-size:14px;color:#868686}.info-view .form-item input{width:100%;height:34px;padding:6px 8px;font-size:14px;color:#333;line-height:20px;vertical-align:middle;background-color:#fafafa;border:1px solid #ddd;border-radius:4px;box-shadow:inset 0 1px 2px rgba(0,0,0,.075)}.info-view .form-item input:focus{border-color:#51a7e8;outline:none;box-shadow:inset 0 1px 2px rgba(0,0,0,.075),0 0 5px rgba(81,167,232,.5)}.info-view .form-item small{color:#a3a3a3;font-size:12px}.info-view .user-avatar{border-radius:8px;width:80px;height:80px;position:relative;overflow:hidden;display:inline-block;vertical-align:bottom;box-shadow:0 0 0 4px rgba(255,255,251,.45)}.info-view .user-avatar img{width:100%;height:100%}.info-view .user-avatar input{position:absolute;cursor:pointer;left:0;top:0;width:100%;height:100%;z-index:1;opacity:0}.info-view .update-btn{margin-top:20px;padding:6px 12px;font-size:14px;color:#333;border:none;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:#eee;background-image:-webkit-gradient(linear,left top,left bottom,from(#fcfcfc),to(#eee));background-image:-webkit-linear-gradient(#fcfcfc,#eee);background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;-webkit-appearance:none}.info-view .update-btn:hover{background-image:-webkit-gradient(linear,left top,left bottom,from(#eee),to(#ddd));background-image:-webkit-linear-gradient(#eee,#ddd);background-image:linear-gradient(#eee,#ddd);border-color:#ccc}.info-view .update-btn:active{background-color:#dcdcdc;background-image:none;border-color:#b5b5b5;box-shadow:inset 0 2px 4px rgba(0,0,0,.15)}@media (max-width:768px){.info-view .form-group{width:100%;padding:5px 15px 15px}}",""])},156:function(e,t,a){var o=a(140);"string"==typeof o&&(o=[[e.id,o,""]]);a(9)(o,{});o.locals&&(e.exports=o.locals)},226:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(49),n=o(i),r=a(233),l=o(r),s=a(18),u=o(s),c=a(4),d=o(c),f=a(2),p=o(f),m=a(3),h=o(m),g=a(6),v=o(g),b=a(5),x=o(b),w=a(1),k=o(w),y=a(15),E=a(13),C=a(17),I=o(C),P=a(60),N=o(P);a(156);var S=function(e){function t(e){(0,p.default)(this,t);var a=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));return a.state={isChange:!1,isSelf:!1,account:void 0,info:{name:"",location:"",avatar:"",github:"",profile:"",website:""}},a.update=a.update.bind(a),a.uploadImg=a.uploadImg.bind(a),a.notice=function(e,t,o){return a.props.actions.execute("notice",e,t,{status:o,styles:{top:"auto",bottom:"30px"}})},a}return(0,x.default)(t,e),(0,h.default)(t,[{key:"componentDidMount",value:function(){this.props.authConf.subscribeEvents("Info",this.loadSelfData.bind(this)),this.getUserInfo()}},{key:"componentWillReceiveProps",value:function(e){e.params.account!==this.state.account&&this.getUserInfo()}},{key:"componentWillUnmount",value:function(){this.props.authConf.unsubscribeEvents("Info")}},{key:"getUserInfo",value:function(){var e=this.context.router.params.account;e?this.loadData(e):this.loadSelfData()}},{key:"loadData",value:function(e){var t=this,a=this.props.auth,o=a.isLogin,i=a.userInfo;return o&&i.account===e?this.loadSelfData():void axios.get("/getUserInfoByAccount",{params:{account:e}}).then(function(a){t.setState({isSelf:!1,account:e,info:a.data})}).catch(function(e){t.notice(e.message,2e3,"error")})}},{key:"loadSelfData",value:function(){var e=this;axios.get("/getUserInfo").then(function(t){var a={};for(var o in e.state.info)a[o]=t.data[o];e.setState({isSelf:!0,info:a})}).catch(function(t){e.notice(t.message,2e3,"error")})}},{key:"update",value:function(){var e=this;this.notice("Uploading data...",0,"loading"),axios.post("/saveUserInfo",{info:this.state.info}).then(function(t){e.notice(t.message,2e3,"success"),e.props.authConf.setUserInfo(e.state.info),e.props.authConf.refresh()}).catch(function(t){e.notice(t.message,2e3,"error")})}},{key:"uploadImg",value:function(e){var t=this,a=e.target.files[0];if(!a)return!1;var o=new FileReader;o.onload=function(e){t.compress(e.target.result).then(function(e){t.setState({info:(0,u.default)({},t.state.info,{avatar:e})})})},o.readAsDataURL(a)}},{key:"compress",value:function(e){return new l.default(function(t,a){var o={width:320,height:320,quality:.92},i=new Image,n=document.createElement("CANVAS");n.width=o.width,n.height=o.height;var r=n.getContext("2d");i.onload=function(){var e=[i.width,i.height],a=void 0,l=void 0,s=void 0;e[0]>e[1]?(l=0,a=(e[0]-e[1])/2,s=e[1]):(a=0,l=(e[1]-e[0])/2,s=e[0]),r.drawImage(i,a,l,s,s,0,0,o.width,o.height),t(n.toDataURL("image/jpeg",o.quality))},i.src=e})}},{key:"handleChange",value:function(e,t){var a=e.target.value;this.setState({isChange:!0,info:(0,u.default)(this.state.info,(0,n.default)({},t,a))})}},{key:"createProps",value:function(e,t){var a=this;return{spellCheck:!1,autoComplete:!1,id:e,ref:e,type:t,value:this.state.info[e],onChange:function(t){return a.handleChange(t,e)}}}},{key:"render",value:function(){return k.default.createElement("div",{ref:"view",className:"info-view"},k.default.createElement("div",{className:"form-group"},this.state.isSelf&&k.default.createElement("div",{className:"form-item"},k.default.createElement("label",{htmlFor:"name"},"Avatar"),k.default.createElement("div",{className:"user-avatar"},k.default.createElement("img",{src:this.state.info.avatar}),k.default.createElement("input",{type:"file",className:"updateHeadImg",onChange:this.uploadImg})),k.default.createElement("small",null," Click the picture to upload avatar ")),k.default.createElement("div",{className:"form-item"},k.default.createElement("label",{htmlFor:"name"},"Name"),k.default.createElement("input",this.createProps("name","text"))),k.default.createElement("div",{className:"form-item"},k.default.createElement("label",{htmlFor:"profile"},"Profile"),k.default.createElement("input",this.createProps("profile","text"))),k.default.createElement("div",{className:"form-item"},k.default.createElement("label",{htmlFor:"website"},"Website"),k.default.createElement("input",this.createProps("website","text"))),k.default.createElement("div",{className:"form-item"},k.default.createElement("label",{htmlFor:"github"},"Github"),k.default.createElement("input",this.createProps("github","text"))),k.default.createElement("div",{className:"form-item"},k.default.createElement("label",{htmlFor:"location"},"Location"),k.default.createElement("input",this.createProps("location","text"))),this.state.isSelf&&k.default.createElement("button",{className:"update-btn",onClick:this.update},"Update Info")),k.default.createElement("div",{className:"modal"}))}}]),t}(w.Component),U=function(e){return{auth:e.auth}},D=function(e){return{actions:(0,E.bindActionCreators)(I.default,e),authConf:(0,E.bindActionCreators)(N.default,e)}};t.default=(0,y.connect)(U,D)(S),S.propTypes={auth:w.PropTypes.object,authConf:w.PropTypes.object,actions:w.PropTypes.object,history:w.PropTypes.object,location:w.PropTypes.object},S.contextTypes={router:k.default.PropTypes.any.isRequired}}});